from jose import jwk
from jose import jwt
from jose.utils import base64url_decode
from jose.backends.rsa_backend import RSAKey
import json

import base64
def stringToBase64(s):
    return base64.b64encode(s.encode('utf-8'))

def base64ToString(b):
    return base64.b64decode(b).decode('utf-8')

token = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJ6WkdEaEVRa3hBZFRvRGZyd0hZcmlRMkpCYmVibUxHMXkyUldYRzN3bl9nIn0.eyJleHAiOjE2NjU4NDI3MTEsImlhdCI6MTY2NTgzOTExMSwiYXV0aF90aW1lIjoxNjY1ODM5MTExLCJqdGkiOiI5ODBkYTE3My03MzEyLTQxNjEtODVhNi01N2NjMDIwOTIxOWQiLCJpc3MiOiJodHRwczovL2F1dGgudnNldGguZXRoei5jaC9hdXRoL3JlYWxtcy9WU0VUSCIsImF1ZCI6InZzZXRoLXRlYW0tMTEiLCJzdWIiOiI1ZmYzYWNiOC01NWIwLTQ0ZWItYjk5Yy0zMWU1MGIyMWQwNWIiLCJ0eXAiOiJJRCIsImF6cCI6InZzZXRoLXRlYW0tMTEiLCJub25jZSI6Im4tMFM2X1d6QTJNaiIsInNlc3Npb25fc3RhdGUiOiI5Y2ZhMTM3Yy03ZjhhLTQzMDAtYjc1Yy1jYTJiMDY4ZTRmNmYiLCJhdF9oYXNoIjoib2hNN0l4MGNYazNGSDV4SnRTdXNhZyIsImFjciI6IjEiLCJzaWQiOiI5Y2ZhMTM3Yy03ZjhhLTQzMDAtYjc1Yy1jYTJiMDY4ZTRmNmYiLCJyZXNvdXJjZV9hY2Nlc3MiOnsidm1wX3Byb2Rfdm1wc2l0ZV92bXBzaXRlIjp7InJvbGVzIjpbInZzZXRoLW1pdGdsaWVkIl19LCJ2aXMtd2Vic2l0ZSI6eyJyb2xlcyI6WyJ2aXMtbWVtYmVyLW9yZGluYXJ5IiwidnNldGgtbWVtYmVyIl19LCJ2c2V0aC1oZWxmZXJ0b29sIjp7InJvbGVzIjpbImxvZ2luIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJuYW1lIjoiQWxleGFuZGVyIFNvdG91ZGVoIiwicHJlZmVycmVkX3VzZXJuYW1lIjoiYXNvdG91ZGVoIiwiZ2l2ZW5fbmFtZSI6IkFsZXhhbmRlciIsImZhbWlseV9uYW1lIjoiU290b3VkZWgifQ.ClsmmFQ5DF3lZ8eaYAJkaDIgJSkbv-V2HJmnPy-G3iYHIOGQudnWfTdEwr3qNoEBoADmdremIl_wkRCqYs0f2ynoFoyD1IMpV9kzkNg3oSfefKhNFFtF1lti3MIh3lusdQgESIxgdBAADtdD5fOqnVP2NKpW6V06sTb3gd2rA75bbav-qcHpyCRCcVNcPoNXZ5ROyZdc4HGLqM0NYRoJ8UHHFLxgAsyOwZTsoxCeRYdcrxDFw-7eaKQ_iZe_a9FagJcs7RtPpTnwbNNQE-Q6j-U2vRvGEhUia8zHY_ZpEnAycbfp79v8VqRTB0ZD6wDEhLbbUj5p1Dpq6ahjqd9sbg&access_token=eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJ6WkdEaEVRa3hBZFRvRGZyd0hZcmlRMkpCYmVibUxHMXkyUldYRzN3bl9nIn0.eyJleHAiOjE2NjU4NDI3MTEsImlhdCI6MTY2NTgzOTExMSwiYXV0aF90aW1lIjoxNjY1ODM5MTExLCJqdGkiOiJlMjM3MDJiNy0zMTg0LTQzYzUtYTAxZS00ZWFhZjExMThiZTYiLCJpc3MiOiJodHRwczovL2F1dGgudnNldGguZXRoei5jaC9hdXRoL3JlYWxtcy9WU0VUSCIsImF1ZCI6WyJ2bXBfcHJvZF92bXBzaXRlX3ZtcHNpdGUiLCJ2aXMtd2Vic2l0ZSIsInZzZXRoLWhlbGZlcnRvb2wiLCJhY2NvdW50Il0sInN1YiI6IjVmZjNhY2I4LTU1YjAtNDRlYi1iOTljLTMxZTUwYjIxZDA1YiIsInR5cCI6IkJlYXJlciIsImF6cCI6InZzZXRoLXRlYW0tMTEiLCJub25jZSI6Im4tMFM2X1d6QTJNaiIsInNlc3Npb25fc3RhdGUiOiI5Y2ZhMTM3Yy03ZjhhLTQzMDAtYjc1Yy1jYTJiMDY4ZTRmNmYiLCJhY3IiOiIxIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtdnNldGgiXX0sInJlc291cmNlX2FjY2VzcyI6eyJ2bXBfcHJvZF92bXBzaXRlX3ZtcHNpdGUiOnsicm9sZXMiOlsidnNldGgtbWl0Z2xpZWQiXX0sInZpcy13ZWJzaXRlIjp7InJvbGVzIjpbInZpcy1tZW1iZXItb3JkaW5hcnkiLCJ2c2V0aC1tZW1iZXIiXX0sInZzZXRoLWhlbGZlcnRvb2wiOnsicm9sZXMiOlsibG9naW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSIsInNpZCI6IjljZmExMzdjLTdmOGEtNDMwMC1iNzVjLWNhMmIwNjhlNGY2ZiIsIm5hbWUiOiJBbGV4YW5kZXIgU290b3VkZWgiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhc290b3VkZWgiLCJnaXZlbl9uYW1lIjoiQWxleGFuZGVyIiwiZmFtaWx5X25hbWUiOiJTb3RvdWRlaCJ9.XGYtMigEgq4L3giIy8iIGSjXzxUCPVFYbGRYVKrrjVAfXWKn3Adb4T4nSqA-YNZEOTAZQ5URMPgi1GV3QcdjCUsXDBtCelX5iFOeMcgSzIV4UzdEmX8qaTNZ6c99t-ynwXVSHPsXarRXK93RMtj8L5JkGKyesCzXKoJbtI1F296_yQasr_UfaGPUXQBgdUy2ViCVlXgrOYMNwh_tW9ZLd1w1v3q1nixjBFfcN4ov9bCymwVLEKj6IQC-QKOLowkhRieuGf_pKSu2LGiNgFKcQedKUxm_ASLSYXXgPONGQmMdRclzrC2JupS4yv2hrpLl-oejXJ6RZgmEBhJr7pptOA"
rsa = json.loads('{"kid":"zZGDhEQkxAdToDfrwHYriQ2JBbebmLG1y2RWXG3wn_g","kty":"RSA","alg":"RS256","use":"sig","n":"tP-L-6HuC6g_d6xJxjdSgTMYusm9HehmbfB_NKbjKPBVQ7ebnoMuvPDI8MMRsQS4_vx5bdkofxD1qresiCJukBFZoZ25r7_WyPLv09VgaHiwevO-Ygy7pb2aySO9ByDrWTfwj2mN4N80GyNXJbH452vYXNdETPmBpawEp5O4uRs08tqxMYq0C4mWSTnAWZazuijmfA0FXUi7juVUEqtqfJYGMWtj5nEOhjvv3u7uNpMPRjz_pk-Ffb-qQZ6PBymCx-jrBm1ThEtRAeSEauXlxHvsfsCEt8fAr1YUR9Xu_16VbA_phZ5gzSrv8D-wdFdEB4BqvI0PpR1TJHzvdD82JQ","e":"AQAB","x5c":["MIICmTCCAYECBgFp08lypTANBgkqhkiG9w0BAQsFADAQMQ4wDAYDVQQDDAVWU0VUSDAeFw0xOTAzMzExMjQ0NDhaFw0yOTAzMzExMjQ2MjhaMBAxDjAMBgNVBAMMBVZTRVRIMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtP+L+6HuC6g/d6xJxjdSgTMYusm9HehmbfB/NKbjKPBVQ7ebnoMuvPDI8MMRsQS4/vx5bdkofxD1qresiCJukBFZoZ25r7/WyPLv09VgaHiwevO+Ygy7pb2aySO9ByDrWTfwj2mN4N80GyNXJbH452vYXNdETPmBpawEp5O4uRs08tqxMYq0C4mWSTnAWZazuijmfA0FXUi7juVUEqtqfJYGMWtj5nEOhjvv3u7uNpMPRjz/pk+Ffb+qQZ6PBymCx+jrBm1ThEtRAeSEauXlxHvsfsCEt8fAr1YUR9Xu/16VbA/phZ5gzSrv8D+wdFdEB4BqvI0PpR1TJHzvdD82JQIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQAhoJ5wE1NVzAclV4KTpFpYPLhoxX6urXAM3/r5E/GFyl1lMww1GJtGCwrdNOFlKfZLh00B2jP7tXFgT7byTjuQjzNH6YWVHzR42pyAN9r5O1hUEOBYp8XeOYKxs1vx6sosiGF6zkbSRE7nSQh3L7VtRKAgU1rw4oqSUVMFIXk+gBbmHi+ZpTWUD/lpHRwBN7wLfZ06glkPqfAOBvAnwG8tvrn61iQbZggjRFZAUBNf2+s68oim8VuAxR2AB+WcGwRKBjceMyVVflpOQhm7wE+rpD4EHWVMsYTWbmcwc/DGyAyCMGUR6LZDCJrCXclr8SPegjPLlxy9ymLYG+2QYrei"],"x5t":"v-3hmaHcRvHUU18Dj5MAQC0MB9c","x5t#S256":"ZXWD5GtYyteHUfVXUbhILrNDhj0JzZhwG5GJVWIQHKM"}')

hmac_key = {
    "kty": "oct",
    "kid": "018c0ae5-4d9b-471b-bfd6-eef314bc7037",
    "use": "sig",
    "alg": "HS256",
    "k": "hJtXIZ2uSN5kbQfbtTNWbpdmhkV8FJG-Onbc6mxCcYg"
}



kes = RSAKey(key=rsa, algorithm="RS256").to_pem()

print(kes)
# res = jwt.decode(token=token, key=kes)